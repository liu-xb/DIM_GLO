# [Domain Adaptive Person Re-Identification via Coupling Optimization](https://dl.acm.org/doi/10.1145/3394171.3413904)
![](https://github.com/liu-xb/DIM_GLO/blob/master/intro.jpg)

Codes of our paper "Domain Adaptive Person Re-Identification via Coupling Optimization" ACM MM 2020. If you find this useful, please kindly cite our paper:

```
@inbook{liu2020dimglo,
author = {Liu, Xiaobin and Zhang, Shiliang},
title = {Domain Adaptive Person Re-Identification via Coupling Optimization},
year = {2020},
publisher = {Association for Computing Machinery},
address = {New York, NY, USA},
url = {https://doi.org/10.1145/3394171.3413904},
pages = {547â€“555},
numpages = {9}
}
```

(Sample code uses Market-1501 as source dataset and DukeMTMC-reID as target dataset.)
## Performance
Market->Duke: Rank1 0.755, mAP 0.575
Duke->Market: Rank1 0.870, mAP 0.643
Market->MSMT17: Rank1 0.487, mAP 0.201
Duke->MSMT17: Rank1 0.565, mAP 0.244

## Dataset

   - Market-1501 [[BaiduYun]](http://pan.baidu.com/s/1ntIi2Op) [[GoogleDriver]](https://drive.google.com/file/d/0B8-rUzbwVRk0c054eEozWG9COHM/view?usp=sharing) CamStyle (generated by CycleGAN) [[GoogleDriver]](https://drive.google.com/open?id=1klY3nBS2sD4pxcyUbSlhtfTk9ButMNW1) [[BaiduYun]](https://pan.baidu.com/s/1NHv1UfI9bKo1XrDx8g70ow) (password: 6bu4)
   
   - DukeMTMC-reID [[BaiduYun]](https://pan.baidu.com/s/1jS0XM7Var5nQGcbf9xUztw) (password: bhbh) [[GoogleDriver]](https://drive.google.com/open?id=1jjE85dRCMOgRtvJ5RQV9-Afs-2_5dY3O) CamStyle (generated by CycleGAN) [[GoogleDriver]](https://drive.google.com/open?id=1tNc-7C3mpSFa_xOti2PmUVXTEiqmJlUI) [[BaiduYun]](https://pan.baidu.com/s/1NHv1UfI9bKo1XrDx8g70ow) (password: 6bu4)
   
   - MSMT17 + CamStyle (generated by StarGAN) [BaiduYun] (password: 6bu4) [GoogleDriver] We reformulate the structure of MSMT17 the same as Market-1501.
   
   Images generated by GAN are provided by [Zhun Zhong](https://github.com/zhunzhong07)
   
## Framework
pytorch >= 1.1.0

## Change path to datasets:
#### Market-1501 (Source):
Change the path of Market-1501 to where your dataset are at Line 81 in train.py.

#### Duke (Target):
Change the path of DukeMTMC-reID to where your dataset are at Line 20 in reid/compute_memory_bank.py, Line 103 and Line 108 in reid/compute_map.py, Line 106, 107 and 108 in reid/DukeDataProvider.py.

The trained model with Market-1501 as source and Duke as target can be downloaded at [here](https://drive.google.com/file/d/1bDs5YGOg1EdqBpPLhuFAieUvn-NaYWus/view?usp=sharing), this model achieves 0.761 and 0.583 in Rank1 and mAP accuracy, respectively.

# Run the code:
Run ``` python train.py ```  in terminal

# Contact me

If you have any question, please feel free to contact me: [Xiaobin Liu](http://liu-xb.github.io)
 
